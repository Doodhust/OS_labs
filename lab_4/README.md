# Лабораторная 4

### Сборка

```bash
cmake -S . -B .cmake
cmake --build .cmake
```

Файлы CMake будут помещены в папку `.cmake`, собранные файлы - в `.build`.


### Симуляция устройства

Таргет в CMake - `device`. 

Исходный код - `./device.cc`.

Передача данных симулирована с помощью именованных каналов, поскольку интерфейс и принцип работы похож на работу с серийным портом. Случайные данные генерируются каждые 5 секунд.


##### Именованный канал

- POSIX: `/tmp/random_temp_pipe`
- Windows: `\\.\pipe\random_temp_pipe`


### Логирование

Таргет в CMake - `logger`

Исходный код - `./logger/`.

Получает данные от `device` через именованный канал. Чтение - блокирующее, если данных нет, будет ждать. Пишет все логи в файл `first.log`, средние из него в `second.log`, средние из него в `third.log`, в каждом из них записи по достижении определенного порога времени жизни удаляются.

- Каждый 1 час записывается среднее за последний 1 час из `first.log` в `second.log`
- Каждый 1 день записывается среднее за последний 1 день из `second.log` в `third.log`
- Записи старше 1 дня удаляются из `first.log`
- Записи старше 1 месяца удаляются из `second.log`
- Записи старше 1 года удаляются из `third.log`


При запуске можно передать ключ `-d`, тогда времена жизни записей в логах будут короче, чтобы можно было увидеть изменения:

- Каждый 30 секунд записывается среднее за последние 30 секунд из `first.log` в `second.log`
- Каждый 2 минуты записывается среднее за последние 2 минуты из `second.log` в `third.log`
- Записи старше 2 минут удаляются из `first.log`
- Записи старше 5 минут удаляются из `second.log`
- Записи старше 10 минут удаляются из `third.log`


> #### Примеры логов приводятся
